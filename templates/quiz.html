{% extends "base.html" %}
{% block title %}Javascipt Quiz | B.Tech Hub{% endblock %}
{% block content %}
<div class="max-w-5xl mx-auto px-4 py-10">
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 dark:text-white">Quiz</h1>
        <p class="text-lg text-gray-600 dark:text-gray-400 mt-2">Test your knowledge with our interactive quizzes!</p>
    </div>
    
    <div class="bg-white shadow-2xl rounded-2xl p-10 w-full max-w-lg">
    <h1 class="text-2xl font-bold text-center mb-6">JavaScript Quiz</h1>

    <!-- Progress Bar -->
    <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
      <div id="progress-bar" class="bg-blue-500 h-3 rounded-full w-0"></div>
    </div>

    <!-- Quiz Container -->
    <div id="quiz" class="space-y-4">
      <h2 id="question" class="text-lg font-semibold"></h2>
      <div id="answer-buttons" class="grid grid-cols-1 gap-3"></div>

      <!-- Navigation Buttons -->
      <div class="flex justify-between mt-4 space-x-2">
        <button id="back-btn" class="bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500">
          Back
        </button>
        <button id="skip-btn" class="bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600">
          Skip
        </button>
        <button id="next-btn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 hidden">
          Next
        </button>
        <button id="submit-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
          Submit
        </button>
      </div>
    </div>

    <!-- Result -->
    <div id="result" class="hidden text-center space-y-4">
      <h2 class="text-xl font-bold">Quiz Finished!</h2>
      <p id="score" class="text-lg"></p>
      <button onclick="startQuiz()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
        Restart
      </button>
    </div>
    <div id="review" class="text-left space-y-6"></div>
    </div>
</div>


<script>
    const questions = [
  {
    question: "What will `console.log(Boolean(0))` print?",
    answers: [
      { text: "true", correct: false },
      { text: "false", correct: true },
      { text: "undefined", correct: false },
      { text: "0", correct: false }
    ]
  },
  {
    question: "How do you write a single-line comment in JavaScript?",
    answers: [
      { text: "// comment", correct: true },
      { text: "<!-- comment -->", correct: false },
      { text: "# comment", correct: false },
      { text: "/* comment */", correct: false }
    ]
  },
  {
    question: "Which method is used to parse a string to an integer?",
    answers: [
      { text: "parseFloat()", correct: false },
      { text: "Number()", correct: false },
      { text: "parseInt()", correct: true },
      { text: "toInteger()", correct: false }
    ]
  },
  {
    question: "What is the default value of an uninitialized variable in JavaScript?",
    answers: [
      { text: "null", correct: false },
      { text: "undefined", correct: true },
      { text: "0", correct: false },
      { text: "NaN", correct: false }
    ]
  },
  {
    question: "Which company developed JavaScript?",
    answers: [
      { text: "Microsoft", correct: false },
      { text: "Sun Microsystems", correct: false },
      { text: "Netscape", correct: true },
      { text: "Oracle", correct: false }
    ]
  },
  {
    question: "Which method removes the last element from an array?",
    answers: [
      { text: "shift()", correct: false },
      { text: "pop()", correct: true },
      { text: "splice()", correct: false },
      { text: "remove()", correct: false }
    ]
  },
  {
    question: "What will `console.log([] == false)` return?",
    answers: [
      { text: "true", correct: true },
      { text: "false", correct: false },
      { text: "undefined", correct: false },
      { text: "NaN", correct: false }
    ]
  },
  {
    question: "What will `typeof NaN` return?",
    answers: [
      { text: "NaN", correct: false },
      { text: "number", correct: true },
      { text: "undefined", correct: false },
      { text: "object", correct: false }
    ]
  },
  {
    question: "Which of the following is NOT a primitive data type in JavaScript?",
    answers: [
      { text: "string", correct: false },
      { text: "boolean", correct: false },
      { text: "object", correct: true },
      { text: "number", correct: false }
    ]
  },
  {
    question: "What is the output of `console.log(1 + true)`?",
    answers: [
      { text: "1", correct: false },
      { text: "2", correct: true },
      { text: "true1", correct: false },
      { text: "NaN", correct: false }
    ]
  }
    ];

    const questionElement = document.getElementById("question");
    const answerButtons = document.getElementById("answer-buttons");
    const nextButton = document.getElementById("next-btn");
    const backButton = document.getElementById("back-btn");
    const skipButton = document.getElementById("skip-btn");
    const submitButton = document.getElementById("submit-btn");
    const resultContainer = document.getElementById("result");
    const quizContainer = document.getElementById("quiz");
    const scoreElement = document.getElementById("score");
    const progressBar = document.getElementById("progress-bar");

    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = Array(questions.length).fill(null); // store answers

    function startQuiz() {
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = Array(questions.length).fill(null);
      quizContainer.classList.remove("hidden");
      resultContainer.classList.add("hidden");
      showQuestion();
    }

    function showQuestion() {
      resetState();
      let currentQuestion = questions[currentQuestionIndex];
      questionElement.innerText = currentQuestion.question;

      currentQuestion.answers.forEach((answer, idx) => {
        const button = document.createElement("button");
        button.innerText = answer.text;
        button.classList =
          "bg-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 text-left";
        button.addEventListener("click", () => selectAnswer(button, idx));
        if (userAnswers[currentQuestionIndex] === idx) {
          button.classList.add("bg-blue-400"); // highlight previous choice
        }
        answerButtons.appendChild(button);
      });

      updateProgressBar();
    }

    function resetState() {
      nextButton.classList.add("hidden");
      answerButtons.innerHTML = "";
    }

    function selectAnswer(button, answerIndex) {
      userAnswers[currentQuestionIndex] = answerIndex;
      Array.from(answerButtons.children).forEach(btn => {
        btn.classList.remove("bg-blue-400");
      });
      button.classList.add("bg-blue-400");
      nextButton.classList.remove("hidden");
    }

    function updateProgressBar() {
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      progressBar.style.width = progress + "%";
    }

    function handleNextButton() {
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        showQuestion();
      } else {
        showResult();
      }
    }

    function handleBackButton() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        showQuestion();
      }
    }

    function handleSkipButton() {
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        showQuestion();
      } else {
        showResult();
      }
    }

    function showResult() {
  score = 0;
  userAnswers.forEach((ans, idx) => {
    if (ans !== null && questions[idx].answers[ans].correct) {
      score++;
    }
  });

  quizContainer.classList.add("hidden");
  resultContainer.classList.remove("hidden");
  scoreElement.innerText = `You scored ${score} out of ${questions.length}`;

  // --- Build Review Section ---
  const reviewContainer = document.getElementById("review");
  reviewContainer.innerHTML = ""; // clear previous

  questions.forEach((q, qIndex) => {
    const questionDiv = document.createElement("div");
    questionDiv.classList.add("p-4", "rounded-lg", "border", "bg-gray-50");

    // Question
    const questionText = document.createElement("h3");
    questionText.innerText = `${qIndex + 1}. ${q.question}`;
    questionText.classList.add("font-semibold", "mb-2");
    questionDiv.appendChild(questionText);

    // Answers
    q.answers.forEach((ans, aIndex) => {
      const ansDiv = document.createElement("div");
      ansDiv.innerText = ans.text;
      ansDiv.classList.add("px-3", "py-1", "rounded", "mb-1");

      // highlight user’s chosen answer
      if (userAnswers[qIndex] === aIndex) {
        if (ans.correct) {
          ansDiv.classList.add("bg-green-300"); // correct chosen
        } else {
          ansDiv.classList.add("bg-red-300"); // wrong chosen
        }
      }

      // highlight correct answer (even if not chosen)
      if (ans.correct) {
        ansDiv.classList.add("border", "border-green-600");
      }

      questionDiv.appendChild(ansDiv);
    });

    // Mark skipped
    if (userAnswers[qIndex] === null) {
      const skippedNote = document.createElement("p");
      skippedNote.innerText = "❌ Not answered";
      skippedNote.classList.add("text-red-500", "mt-2");
      questionDiv.appendChild(skippedNote);
    }

    reviewContainer.appendChild(questionDiv);
  });
}
    nextButton.addEventListener("click", handleNextButton);
    backButton.addEventListener("click", handleBackButton);
    skipButton.addEventListener("click", handleSkipButton);
    submitButton.addEventListener("click", showResult);

    startQuiz();
  </script>


{% endblock %}